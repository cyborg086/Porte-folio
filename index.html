<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio | Automatisme & Énergie</title>
    
    <!-- Import de la police Google Fonts (Roboto pour la propreté) -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <!-- Import des icônes FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Import Markdown Parser pour les réponses de l'IA -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* ================= VARIABLES & RESET ================= */
        :root {
            --primary-blue: #001f3f;      /* Bleu Marine : Rigueur, EDF, Technique */
            --accent-yellow: #FFD700;     /* Jaune : Énergie, Électricité, Dynamisme */
            --bg-color: #f4f6f8;          /* Gris très clair pour le fond de page */
            --card-bg: #ffffff;           /* Blanc pour les cases */
            --text-dark: #333333;
            --text-light: #666666;
            --shadow: 0 4px 6px rgba(0,0,0,0.05); /* Ombre douce pour l'effet "case" */
            --ai-color: #6e44ff;          /* Violet pour les features IA */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* ================= LAYOUT GÉNÉRAL ================= */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }

        section {
            margin-bottom: 60px;
        }

        /* Titres de section */
        .section-title {
            text-align: center;
            color: var(--primary-blue);
            font-size: 2rem;
            margin-bottom: 30px;
            position: relative;
            padding-bottom: 10px;
        }

        /* Petite ligne jaune sous les titres */
        .section-title::after {
            content: '';
            display: block;
            width: 60px;
            height: 4px;
            background-color: var(--accent-yellow);
            margin: 10px auto 0;
            border-radius: 2px;
        }

        /* ================= COMPOSANT "CASE" (CARD) ================= */
        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 40px;
            box-shadow: var(--shadow);
            border-top: 4px solid var(--primary-blue);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0,0,0,0.1);
        }

        /* ================= HEADER / HERO (MODIFIÉ POUR PHOTO) ================= */
        header {
            background-color: var(--primary-blue);
            color: white;
            padding: 60px 0 100px 0; /* Un peu plus d'espace en bas pour la découpe */
            clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
            margin-bottom: 50px;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 60px; /* Espace aéré entre le texte et la photo */
            flex-wrap: wrap; /* Pour que ça passe à la ligne sur mobile */
        }

        .header-text {
            text-align: left;
            max-width: 600px;
        }

        header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            line-height: 1.2;
        }

        header .subtitle {
            font-size: 1.2rem;
            font-weight: 300;
            color: var(--accent-yellow);
            letter-spacing: 1px;
            margin-top: 0;
        }

        /* --- DESIGN DU HUBLOT (PHOTO DE PROFIL) --- */
        .profile-photo {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            object-fit: cover; /* Recadre l'image proprement sans la déformer */
            
            /* Construction du style "Hublot" */
            border: 4px solid white; /* 1. Joint d'étanchéité (blanc) */
            box-shadow: 
                0 0 0 6px var(--accent-yellow), /* 2. Cerclage de sécurité (jaune) */
                0 0 0 12px var(--primary-blue), /* 3. Structure externe (bleu marine) */
                0 15px 35px rgba(0,0,0,0.4),    /* 4. Ombre portée profonde pour le relief */
                inset 0 0 20px rgba(0,0,0,0.3); /* 5. Ombre interne pour l'effet vitre */
            
            background-color: white;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.4s ease;
            cursor: pointer;
        }

        .profile-photo:hover {
            transform: scale(1.05); /* Léger zoom avant au survol */
            box-shadow: 
                0 0 0 6px var(--accent-yellow),
                0 0 0 12px var(--primary-blue),
                0 20px 45px rgba(0,0,0,0.5), /* L'ombre grandit */
                inset 0 0 10px rgba(0,0,0,0.1); /* L'ombre interne diminue (plus de lumière) */
        }

        /* ================= SECTION OBJECTIFS & IA FIT ================= */
        .objective-content {
            font-size: 1.1rem;
            color: var(--text-dark);
            text-align: justify;
        }
        
        .highlight {
            color: var(--primary-blue);
            font-weight: bold;
            background-color: rgba(255, 215, 0, 0.2);
            padding: 0 4px;
        }

        /* Style pour l'analyseur de compatibilité IA */
        .ai-fit-container {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px dashed #ddd;
        }

        .ai-input-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .ai-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 6px;
            font-family: inherit;
        }

        .ai-btn {
            background: linear-gradient(135deg, var(--primary-blue), var(--ai-color));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: opacity 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-btn:hover {
            opacity: 0.9;
        }

        .ai-result {
            margin-top: 15px;
            padding: 15px;
            background-color: #f0f7ff;
            border-left: 4px solid var(--ai-color);
            border-radius: 4px;
            font-size: 0.95rem;
            display: none; /* Caché par défaut */
        }

        /* ================= SECTION PASSIONS (2 Colonnes) ================= */
        .passions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .passion-icon {
            font-size: 2.5rem;
            color: var(--accent-yellow);
            margin-bottom: 20px;
            display: block;
            text-align: center;
        }

        /* ================= SECTION COMPÉTENCES ================= */
        .skills-container {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }

        .skill-box {
            flex: 1;
            min-width: 300px;
        }

        .skill-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--bg-color);
            padding-bottom: 10px;
        }

        .skill-header i {
            background-color: var(--primary-blue);
            color: var(--accent-yellow);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-right: 15px;
        }

        .skill-list {
            list-style: none;
        }

        .skill-list li {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }

        .skill-list li::before {
            content: '•';
            color: var(--accent-yellow);
            font-weight: bold;
            font-size: 1.5rem;
            position: absolute;
            left: 0;
            top: -5px;
        }

        /* ================= SECTION PROJETS ================= */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .project-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }
        
        .project-card:hover {
            transform: translateY(-5px);
        }

        /* Style pour les vraies images dans les cartes */
        .project-card img {
            width: 100%;
            height: 180px;
            object-fit: cover; /* Recadre l'image sans la déformer */
            display: block;
        }

        .project-img-placeholder {
            width: 100%;
            height: 180px;
            background-color: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #777;
            font-weight: bold;
        }

        .project-body {
            padding: 20px;
        }

        .project-body h3 {
            color: var(--primary-blue);
            margin-bottom: 10px;
        }

        .tags {
            margin-top: 15px;
        }

        .tag {
            display: inline-block;
            background-color: var(--primary-blue);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 5px;
        }

        /* ================= CHATBOT IA ================= */
        .chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            font-family: 'Roboto', sans-serif;
        }

        .chat-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--ai-color), var(--primary-blue));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: transform 0.3s;
            border: none;
        }

        .chat-btn:hover {
            transform: scale(1.1);
        }

        .chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 450px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            display: none; /* Caché par défaut */
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #eee;
        }

        .chat-header {
            background: var(--primary-blue);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h4 {
            margin: 0;
            font-size: 1rem;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #f9f9f9;
        }

        .message {
            margin-bottom: 10px;
            max-width: 80%;
            padding: 10px;
            border-radius: 10px;
            font-size: 0.9rem;
            word-wrap: break-word;
        }

        .message.bot {
            background-color: #e2e8f0;
            color: var(--text-dark);
            align-self: flex-start;
            border-bottom-left-radius: 0;
        }

        .message.user {
            background-color: var(--ai-color);
            color: white;
            margin-left: auto; /* Aligne à droite */
            border-bottom-right-radius: 0;
        }

        .chat-input-area {
            padding: 10px;
            border-top: 1px solid #eee;
            display: flex;
            gap: 5px;
            background: white;
        }

        .chat-input-area input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }

        .chat-input-area button {
            background: var(--primary-blue);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .typing-indicator {
            font-style: italic;
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 5px;
            display: none;
        }

        /* ================= FOOTER ================= */
        footer {
            background-color: var(--primary-blue);
            color: white;
            text-align: center;
            padding: 40px 0;
            margin-top: 80px;
        }

        .social-links a {
            color: white;
            margin: 0 15px;
            font-size: 1.5rem;
            transition: color 0.3s;
        }

        .social-links a:hover {
            color: var(--accent-yellow);
        }

        /* ================= RESPONSIVE ================= */
        @media (max-width: 768px) {
            .passions-grid {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 2rem;
            }

            .header-content {
                flex-direction: column-reverse; /* Photo au dessus du texte sur mobile */
                text-align: center;
            }

            .header-text {
                text-align: center;
            }

            .chat-window {
                width: 300px;
                right: -10px; /* Ajustement mobile */
            }
        }
    </style>
</head>
<body>

    <!-- EN-TÊTE MODIFIÉ AVEC PHOTO -->
    <header>
        <div class="container">
            <div class="header-content">
                <!-- Bloc Texte (Nom + Titre) -->
                <div class="header-text">
                    <h1>Baptiste MAIZEAUD</h1>
                    <p class="subtitle">BUT GEII | Futur Ingénieur en Énergie & Automatisme</p>
                </div>
                
                <!-- Bloc Photo de Profil -->
                <div class="header-photo">
                    <!-- IMAGE MISE À JOUR ICI -->
                    <img src="1000015067.jpg" alt="Baptiste Maizeaud" class="profile-photo">
                </div>
            </div>
        </div>
    </header>

    <div class="container">

        <!-- 1. OBJECTIFS & IA FIT ANALYZER -->
        <section id="objectifs">
            <h2 class="section-title">Objectifs Professionnels</h2>
            <div class="card">
                <div class="objective-content">
                    <p>
                        Mon parcours actuel en <span class="highlight">BUT Génie Électrique et Informatique Industrielle (GEII)</span> est la fondation stratégique de mon projet professionnel. Fort de mes connaissances en automatismes, en électronique de puissance et en systèmes embarqués, mon ambition claire est de devenir Ingénieur.
                    </p>
                    <br>
                    <p>
                        Je souhaite mettre ces compétences techniques pointues au service d'un acteur majeur de la transition énergétique. Mon objectif ultime est d'intégrer le groupe <span class="highlight">EDF</span> afin de participer activement aux défis de la production et de la distribution d'énergie.
                    </p>

                    <!-- ✨ FEATURE IA 1 : ANALYSE DE COMPATIBILITÉ -->
                    <div class="ai-fit-container">
                        <h4 style="color: var(--ai-color); display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-magic"></i> Analyseur de Compatibilité (IA)
                        </h4>
                        <p style="font-size: 0.9rem; margin-bottom: 10px;">Recruteurs, entrez votre secteur (ex: Nucléaire, Automobile, R&D) pour voir comment mon profil s'adapte à vos besoins.</p>
                        
                        <div class="ai-input-group">
                            <input type="text" id="sectorInput" class="ai-input" placeholder="Votre secteur d'activité (ex: Aéronautique)...">
                            <button class="ai-btn" onclick="analyzeFit()">
                                Analyser ✨
                            </button>
                        </div>
                        <div id="aiFitResult" class="ai-result"></div>
                    </div>

                </div>
            </div>
        </section>

        <!-- 2. PASSIONS & SOFT SKILLS (Séparé en deux cases) -->
        <section id="passions">
            <h2 class="section-title">Profil & Approche</h2>
            <div class="passions-grid">
                
                <!-- Case 1 : Performance -->
                <div class="card">
                    <i class="fas fa-tachometer-alt passion-icon"></i>
                    <h3>Performance & Précision</h3>
                    <p style="margin-top: 15px; text-align: justify;">
                        Mes centres d'intérêt reflètent une affinité pour la performance. L'énergie, qu'elle soit au cœur des systèmes complexes que j'étudie ou un enjeu sociétal, capte mon attention. Cette recherche d'excellence se retrouve dans mon admiration pour la <strong>Formule 1</strong> et le <strong>Rally</strong>, symboles d'ingénierie poussée et de gestion de risques.
                    </p>
                </div>

                <!-- Case 2 : Persévérance -->
                <div class="card">
                    <i class="fas fa-running passion-icon"></i>
                    <h3>Persévérance & Rigueur</h3>
                    <p style="margin-top: 15px; text-align: justify;">
                        Ma pratique du vélo et de la <strong>course à pieds</strong> exige de l'endurance, tandis que le <strong>piano</strong> m'apporte la rigueur et le souci du détail nécessaires à la réussite de projets complexes. Ces passions m'animent et me préparent à aborder avec méthode les défis techniques de l'ingénierie.
                    </p>
                </div>

            </div>
        </section>

        <!-- 3. COMPÉTENCES TECHNIQUES (Style Liste propre) -->
        <section id="competences">
            <h2 class="section-title">Compétences Techniques</h2>
            <div class="skills-container">
                
                <!-- Case Concevoir -->
                <div class="card skill-box">
                    <div class="skill-header">
                        <i class="fas fa-drafting-compass"></i>
                        <h3>I. Concevoir</h3>
                    </div>
                    <ul class="skill-list">
                        <li><strong>Analyse fonctionnelle :</strong> Identifier les fonctions, contraintes et besoins d'un système simple.</li>
                        <li><strong>Prototypage :</strong> Réaliser des solutions techniques matérielles et logicielles (Arduino, API).</li>
                        <li><strong>Documentation :</strong> Rédiger un dossier de fabrication (spécifications, nomenclatures).</li>
                    </ul>
                </div>

                <!-- Case Vérifier -->
                <div class="card skill-box">
                    <div class="skill-header">
                        <i class="fas fa-check-double"></i>
                        <h3>II. Vérifier</h3>
                    </div>
                    <ul class="skill-list">
                        <li><strong>Essais :</strong> Appliquer une procédure de test par rapport aux spécifications.</li>
                        <li><strong>Diagnostic :</strong> Identifier et localiser l'origine d'une panne (dysfonctionnement).</li>
                        <li><strong>Maintenance :</strong> Formaliser l'anomalie de manière claire pour la correction.</li>
                    </ul>
                </div>

            </div>
        </section>

        <!-- 4. PROJETS (Grille de cartes) -->
        <section id="projets">
            <h2 class="section-title">Projets Réalisés (SAE)</h2>
            <div class="projects-grid">
                
                <!-- Projet 1 -->
                <article class="project-card">
                    <div class="project-img-placeholder">
                        <i class="fas fa-industry fa-3x"></i>
                    </div>
                    <div class="project-body">
                        <h3>Automatisme Chaîne de Prod.</h3>
                        <p>Programmation d'un automate pour la gestion d'une ligne d'assemblage. Analyse fonctionnelle et Grafcet.</p>
                        <div class="tags">
                            <span class="tag">PLC</span>
                            <span class="tag">Grafcet</span>
                        </div>
                    </div>
                </article>

                <!-- Projet 2 -->
                <article class="project-card">
                    <div class="project-img-placeholder">
                        <i class="fas fa-thermometer-half fa-3x"></i>
                    </div>
                    <div class="project-body">
                        <h3>Régulateur de Température</h3>
                        <p>Conception d'un système de régulation thermique. Choix des capteurs et programmation de la boucle de contrôle.</p>
                        <div class="tags">
                            <span class="tag">Électronique</span>
                            <span class="tag">Régulation</span>
                        </div>
                    </div>
                </article>

                <!-- Projet 3 -->
                <article class="project-card">
                    <div class="project-img-placeholder">
                        <i class="fas fa-robot fa-3x"></i>
                    </div>
                    <div class="project-body">
                        <h3>Robot Joueur de Tennis</h3>
                        <p>Développement technique complet (mécanique et logiciel) d'un lanceur de balles automatisé.</p>
                        <div class="tags">
                            <span class="tag">Système Embarqué</span>
                            <span class="tag">Mécanique</span>
                        </div>
                    </div>
                </article>

                <!-- Projet 4 (SAE Multimètre) -->
                <article class="project-card">
                    <!-- Assurez-vous que l'image du multimètre est bien dans le dossier -->
                    <img src="1763544704584 (1).jpg" alt="Multimètre Numérique SAE">
                    
                    <div class="project-body">
                        <h3>SAE Multimètre</h3>
                        <p>Conception, soudure et calibration d'un multimètre numérique. Validation des chaînes de mesure (tension, courant).</p>
                        <div class="tags">
                            <span class="tag">Électronique</span>
                            <span class="tag">Mesure</span>
                        </div>
                    </div>
                </article>

            </div>
        </section>

    </div>

    <!-- ✨ FEATURE IA 2 : CHATBOT FLOTTANT -->
    <div class="chat-widget">
        <button class="chat-btn" onclick="toggleChat()" title="Discuter avec l'assistant IA">
            <i class="fas fa-comment-dots"></i>
        </button>
        
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <h4>Assistant Virtuel ✨</h4>
                <i class="fas fa-times" style="cursor:pointer" onclick="toggleChat()"></i>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message bot">
                    Bonjour ! Je suis l'assistant IA de Baptiste. Je connais son portfolio par cœur. Une question sur ses compétences ou ses projets ?
                </div>
            </div>
            <div class="typing-indicator" id="typingIndicator">L'IA réfléchit...</div>
            <div class="chat-input-area">
                <input type="text" id="chatInput" placeholder="Votre question..." onkeypress="handleEnter(event)">
                <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <div class="container">
            <h3>Me Contacter</h3>
            <p style="margin: 15px 0;">baptiste.maizeaud@gmail.com</p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/baptiste-maizeaud-118008384"><i class="fab fa-linkedin"></i></a>
                <a href="https://github.com/cyborg086"><i class="fab fa-github"></i></a>
                <a href="#"><i class="fas fa-envelope"></i></a>
            </div>
            <p style="margin-top: 30px; font-size: 0.8rem; opacity: 0.7;">© 2025 - Portfolio Ingénieur</p>
        </div>
    </footer>

    <!-- SCRIPT POUR GEMINI API -->
    <script>
        // ================= CONFIGURATION =================
        const apidebut="AIza";
        const apifin="SyBDi93n_Ek52G2iP__ykBvrmTRcoLo0qSQ";
        const apiKey = apidebut+apifin; // La clé sera injectée par l'environnement
        const MODEL_NAME = "gemini-2.5-flash-preview-09-2025";
        
        // Contexte global extrait du site pour l'IA
        const getPortfolioContext = () => {
            const bodyText = document.body.innerText;
            // Nettoyage sommaire
            return bodyText.replace(/\s+/g, ' ').substring(0, 10000); 
        };

        // Fonction générique d'appel à l'API
        async function callGeminiAPI(prompt, systemInstruction = "") {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemInstruction }] }
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error("Erreur API");
                
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "Désolé, je n'ai pas pu générer de réponse.";
            } catch (error) {
                console.error(error);
                return "Une erreur est survenue lors de la communication avec l'IA.";
            }
        }

        // ================= FEATURE 1: ANALYSE COMPATIBILITÉ =================
        async function analyzeFit() {
            const sector = document.getElementById('sectorInput').value;
            const resultDiv = document.getElementById('aiFitResult');
            const btn = document.querySelector('.ai-btn');
            
            if (!sector) return;

            // UI Loading
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyse...';
            btn.disabled = true;
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = "L'IA analyse le profil de Baptiste pour le secteur " + sector + "...";

            // Prompt
            const context = getPortfolioContext();
            const systemPrompt = "Tu es un consultant carrière expert. Ton but est de 'vendre' le profil de Baptiste Maizeaud à un recruteur d'un secteur spécifique. Sois convaincant, professionnel et bref (max 3 phrases).";
            const userPrompt = `Voici le portfolio de Baptiste : """${context}""". \n\n Le recruteur travaille dans ce secteur : "${sector}". Explique pourquoi Baptiste est un bon candidat pour ce secteur spécifique en liant ses compétences (GEII, Automatisme, Rigueur) aux besoins de ce secteur.`;

            // Call API
            const response = await callGeminiAPI(userPrompt, systemPrompt);

            // Render Markdown
            resultDiv.innerHTML = marked.parse(response);
            
            // Reset UI
            btn.innerHTML = 'Analyser ✨';
            btn.disabled = false;
        }

        // ================= FEATURE 2: CHATBOT =================
        function toggleChat() {
            const win = document.getElementById('chatWindow');
            win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
        }

        function handleEnter(e) {
            if (e.key === 'Enter') sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const messages = document.getElementById('chatMessages');
            const indicator = document.getElementById('typingIndicator');
            const userText = input.value;

            if (!userText.trim()) return;

            // Afficher message utilisateur
            const userDiv = document.createElement('div');
            userDiv.className = 'message user';
            userDiv.innerText = userText;
            messages.appendChild(userDiv);
            
            input.value = '';
            messages.scrollTop = messages.scrollHeight;
            indicator.style.display = 'block';

            // Prompt
            const context = getPortfolioContext();
            const systemPrompt = `Tu es l'assistant virtuel professionnel de Baptiste Maizeaud. Tu réponds aux questions des recruteurs en te basant STRICTEMENT sur le contenu de son portfolio ci-dessous. 
            Sois poli, concis et mets en avant ses qualités (Rigueur, Passion F1/Piano, Compétences GEII).
            Si la réponse n'est pas dans le portfolio, dis poliment que tu ne sais pas mais propose de le contacter par email.
            
            Portfolio Context:
            ${context}`;

            // Call API
            const aiResponse = await callGeminiAPI(userText, systemPrompt);

            // Afficher réponse IA
            indicator.style.display = 'none';
            const botDiv = document.createElement('div');
            botDiv.className = 'message bot';
            botDiv.innerHTML = marked.parse(aiResponse); // Support markdown dans le chat
            messages.appendChild(botDiv);
            messages.scrollTop = messages.scrollHeight;
        }
    </script>
</body>
</html>